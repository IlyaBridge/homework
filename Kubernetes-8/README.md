#  «Домашнее задание к занятию» "`Компоненты Kubernetes`" - `Казначеев Илья`

https://github.com/netology-code/kuber-homeworks/blob/shkuber-16/3.1/3.1.md

# Домашнее задание к занятию «Компоненты Kubernetes»

### Цель задания

Рассчитать требования к кластеру под проект

------

### Инструменты и дополнительные материалы, которые пригодятся для выполнения задания:

- [Considerations for large clusters](https://kubernetes.io/docs/setup/best-practices/cluster-large/),
- [Architecting Kubernetes clusters — choosing a worker node size](https://learnk8s.io/kubernetes-node-size).

------

## Задание. Необходимо определить требуемые ресурсы
Известно, что проекту нужны база данных, система кеширования, а само приложение состоит из бекенда и фронтенда. Опишите, какие ресурсы нужны, если известно:

1. Необходимо упаковать приложение в чарт для деплоя в разные окружения. 
2. База данных должна быть отказоустойчивой. Потребляет 4 ГБ ОЗУ в работе, 1 ядро. 3 копии. 
3. Кеш должен быть отказоустойчивый. Потребляет 4 ГБ ОЗУ в работе, 1 ядро. 3 копии. 
4. Фронтенд обрабатывает внешние запросы быстро, отдавая статику. Потребляет не более 50 МБ ОЗУ на каждый экземпляр, 0.2 ядра. 5 копий. 
5. Бекенд потребляет 600 МБ ОЗУ и по 1 ядру на копию. 10 копий.

## Ответ

### Исходные данные:
- База данных: 3 копии × (4 ГБ RAM, 1 CPU)
- Кеш: 3 копии × (4 ГБ RAM, 1 CPU)
- Бэкенд: 10 копий × (600 МБ RAM, 1 CPU)
- Фронтенд: 5 копий × (50 МБ RAM, 0.2 CPU)

### Расчёт ресурсов:
БД: 12 ГБ RAM, 3 CPU  
Кеш: 12 ГБ RAM, 3 CPU  
Бэкенд: 6 ГБ RAM, 10 CPU  
Фронтенд: 0.25 ГБ RAM, 1 CPU  

### Итого: 30.25 ГБ RAM, 17 CPU

### Учёт системных ресурсов и запаса:
1. + ~10–15% служебные процессы (kubelet и пр. на каждую ноду)  
2. + ~25% запас на будущее расширение  

### С учётом запаса:  
RAM ≈ 38 ГБ, CPU ≈ 21 ядро

### Рекомендуемая конфигурация ноды:
8 CPU, 32 ГБ RAM, SSD 200 ГБ

### Расчёт нод:
Для нагрузки и отказоустойчивости - 4 воркер-ноды.  
При потере одной остаётся: 3 × (7.5 CPU, 31 ГБ RAM) = 22.5 CPU, 93 ГБ RAM, этого достаточно с запасом.

### Итог:
- Количество мастер-нод: 3 (по 2 CPU, 4 ГБ RAM)  
- Количество воркер-нод: 4 (по 8 CPU, 32 ГБ RAM)  
- Общие ресурсы: 32 CPU, 128 ГБ RAM  
- Запас по CPU ~1.9x, по RAM ~3.5x (учтено расширение)

Конфигурация предусматривает запас производительности и памяти для масштабирования системы на 1-2 года вперёд без изменения архитектуры кластера.

### Обоснование выбора нод:
Ноды среднего размера обеспечивают баланс между отказоустойчивостью, управляемостью и эффективным использованием ресурсов. Более мелкие ноды создают нагрузку на control plane, а слишком большие усложняют восстановление при сбоях.

----

## Правила приёма работы

1. Домашняя работа оформляется в своем Git-репозитории в файле README.md. Выполненное домашнее задание пришлите ссылкой на .md-файл в вашем репозитории.
2. Сначала сделайте расчёт всех необходимых ресурсов.
3. Затем прикиньте количество рабочих нод, которые справятся с такой нагрузкой.
4. Добавьте к полученным цифрам запас, который учитывает выход из строя как минимум одной ноды. 
5. Добавьте служебные ресурсы к нодам. Помните, что для разных типов нод требовния к ресурсам разные. 
6. В результате должно быть указано количество нод и их параметры.

