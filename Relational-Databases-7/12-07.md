# Домашнее задание к занятию "`Репликация и масштабирование. Часть 2`" - `Казначеев Илья`

---

### Задание 1
Опишите основные преимущества использования масштабирования методами:
активный master-сервер и пассивный репликационный slave-сервер;
master-сервер и несколько slave-серверов;
Дайте ответ в свободной форме.


### Решение 1
1. Активный master-сервер и пассивный репликационный slave-сервер

В данной схеме есть один основной сервер (master), который обрабатывает все запросы на запись (INSERT, UPDATE, DELETE), и один или несколько подчиненных серверов (slave), которые реплицируют данные с master-сервера и используются для чтения данных (SELECT).

Преимущества:
- Распределение нагрузки. Запросы на чтение могут быть распределены между slave-серверами. Это снижает нагрузку на master-сервер.
- Отказоустойчивость. Если master-сервер выходит из строя, один из slave-серверов может быть повышен до роли master, это обеспечивает непрерывность работы системы.
- Резервное копирование. Slave-серверы могут использоваться для создания резервных копий данных без нагрузки на master-сервер.
- Географическое распределение. Slave-серверы могут быть расположены в разных регионах, тем самым уменьшая задержку для пользователей в этих регионах.

2. Master-сервер и несколько slave-серверов

В данной схеме также используется один master-сервер для обработки запросов на запись, но несколько slave-серверов для обработки запросов на чтение.

Преимущества:
- Еще большее распределение нагрузки. С увеличением числа slave-серверов нагрузка на чтение распределяется еще более равномерно, что позволяет обслуживать большее количество пользователей.
- Масштабируемость. Добавление новых slave-серверов позволяет легко масштабировать систему по мере роста нагрузки.
- Повышенная отказоустойчивость. Наличие нескольких slave-серверов увеличивает отказоустойчивость системы, так-как в случае выхода из строя одного slave-сервера другие продолжают работать.
- Гибкость в управлении нагрузкой. Можно настроить разные slave-серверы для обработки разных типов запросов или для обслуживания разных групп пользователей.

---

### Задание 2
Разработайте план для выполнения горизонтального и вертикального шаринга базы данных. База данных состоит из трёх таблиц:
    пользователи,
    книги,
    магазины (столбцы произвольно).
Опишите принципы построения системы и их разграничение или разбивку между базами данных.
Пришлите блоксхему, где и что будет располагаться. Опишите, в каких режимах будут работать сервера.

### Решение 2

#### Горизонтальный шардинг
Горизонтальный шардинг предполагает разделение данных одной таблицы на несколько серверов. Так, например, данные таблицы "пользователи" могут быть разделены по географическому признаку: пользователи из Европы на одном сервере, из Азии — на другом.

Принципы построения:
1. Ключ шардинга. Выбирается ключ для разделения данных (например, user_id).
2. Распределение данных. Данные распределяются между серверами на основе выбранного ключа.
3. Маршрутизация запросов. Приложение или промежуточный слой (например, прокси) определяет, на какой сервер направить запрос, основываясь на ключе шардинга.

Пример разделения по диапазону:
Сервер 1: Пользователи с ID от 1 до 1000.
Сервер 2: Пользователи с ID от 1001 до 2000.
Сервер 3: Пользователи с ID от 2001 до 3000.

Блок-схема:
![image](https://github.com/user-attachments/assets/4d926088-ad88-4ef5-be1f-963bbdc9ed5f)

#### Вертикальный шардинг
Вертикальный шардинг предполагает разделение таблиц между разными серверами. Например, таблица "пользователи" на одном сервере, таблица "книги" — на другом, таблица "магазины" — на третьем.

Принципы построения:
1. Каждая таблица находится на отдельном сервере.
2. Каждый сервер специализируется на обработке данных определенного типа.
3. Распределение таблиц по разным серверам уменьшает нагрузку на каждый отдельный сервер.

Пример разделения:
Сервер 1: Таблица "пользователи".
Сервер 2: Таблица "книги".
Сервер 3: Таблица "магазины".

Блок-схема:
![image](https://github.com/user-attachments/assets/52125135-0b10-40eb-ae99-55aa9ed0a31f)

#### Комбинированный шардинг (горизонтальный + вертикальный)
Комбинированный шардинг объединяет оба подхода. Например, таблица "пользователи" разделяется горизонтально, а таблицы "книги" и "магазины" — вертикально.

Принципы построения:
1. Горизонтальное разделение. Таблица "пользователи" разделяется по ключу (например, user_id).
2. Вертикальное разделение. Таблицы "книги" и "магазины" размещаются на отдельных серверах.
3. Маршрутизация запросов. Приложение или промежуточный слой определяет, на какой сервер направить запрос.

Пример разделения:
Сервер 1: Пользователи с ID от 1 до 1000.
Сервер 2: Пользователи с ID от 1001 до 2000.
Сервер 3: Таблица "книги".
Сервер 4: Таблица "магазины".

Блок-схема:
![image](https://github.com/user-attachments/assets/8d066c33-31e5-4aad-a152-e8f7e2f8eab8)

#### Шардинг на основе функциональности
В этом случае данные разделяются на основе функциональности приложения. Например, один сервер отвечает за данные, связанные с пользователями, другой — за данные, связанные с книгами и магазинами.

Принципы построения:
1. Функциональное разделение. Данные группируются по функциональным областям приложения.
2. Специализация серверов. Каждый сервер отвечает за определённую функциональность.
3. Связи между данными. Если данные связаны (например, заказы пользователей и книги), необходимо настроить механизмы для выполнения запросов между серверами.

Пример разделения:
Сервер 1: Пользователи и их данные (например, профили, заказы).
Сервер 2: Книги и магазины (например, каталог книг, информация о магазинах).

Блок-схема:
![image](https://github.com/user-attachments/assets/3b7de12a-f938-4711-a73f-ea0b7819a126)

#### Режимы работы серверов
1. Master-Slave:
- Master-сервер: Обрабатывает запросы на запись (INSERT, UPDATE, DELETE).
- Slave-сервера: Обрабатывают запросы на чтение (SELECT).
- Пример: Master-сервер для таблицы "пользователи", Slave-серверы для чтения данных.
2. Active-Active:
- Все серверы могут обрабатывать как запросы на запись, так и на чтение. (увеличивает производительность и отказоустойчивость)
- Пример: Несколько серверов для таблицы "книги", каждый из которых может принимать запросы на запись и чтение.

---
