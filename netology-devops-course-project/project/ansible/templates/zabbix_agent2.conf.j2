# /home/ilya/project/ansible/zabbix_agent2.conf.j2
# Основные настройки
PidFile=/var/run/zabbix/zabbix_agent2.pid
LogFile=/var/log/zabbix/zabbix_agent2.log
LogFileSize=10

# Подключение к Zabbix Server
Server={{ zabbix_server_ip }}
ServerActive={{ zabbix_server_ip }}
Hostname={{ inventory_hostname }}  # Имя хоста в Zabbix (совпадает с inventory)

# Дополнительные плагины
Plugins.SystemRun.LogRemoteCommands=1
Plugins.HTTP.Timeout=10

# 
EnableRemoteCommands=0  # Отключает выполнение команд с сервера (по умолчанию)
ListenIP=0.0.0.0  # Явно указываем интерфейс
AllowRoot=0  # Запрет работы под root
TLSConnect=unencrypted  # Если не используете шифрование
TLSAccept=unencrypted

StartAgents=3  # Количество процессов агента
BufferSize=100  # Размер буфера для данных
Timeout=30  # Таймаут соединения

DebugLevel=3  # Уровень детализации логов (1-5)
LogType=file  # Писать логи в файл, а не в syslog

HostMetadata=linux  # Группировка в Zabbix